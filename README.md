
# Техническое задание: Микросервис для управления запчастями и поставками

## Создание виртуального окружения
```bash
python3.13 -m venv env
```
## Установка зависимостей
```bash
pip install requirements.txt
```
## Запускаем контейнер
```bash
docker-compose up -d --build 
```
## Запускаем программу
```bash
python3.13 main.py
```
## Описание проекта

Разработать микросервис на **FastAPI**, который предоставляет CRUD-операции для управления следующими сущностями:

1. **Запчасти (Parts)**  
2. **Поставщики (Suppliers)**  
3. **Поставки (Supplies)** 

Данные должны храниться в базе данных **PostgreSQL**, взаимодействие с которой осуществляется с использованием библиотеки **psycopg2** через raw SQL-запросы.

---

## Задачи
### Запчасти (Parts)
1. **API для создания новой запчасти (POST)**
2. **API для обновления данных о запчасти (PATCH)**
3. **API для получения списка всех запчастей (GET)**
4. **API для удаления запчасти (DELETE)**
### Поставщики (Suppliers)
1. **API для создания нового поставщика (POST)**
2. **API для обновления данных о поставщике (PATCH)**
3. **API для получения списка всех поставщиков (GET)**
4. **API для удаления поставщика (DELETE)**
### Поставки (Supplies)
1. **API для создания новой поставке (POST)**
2. **API для обновления данных о поставке (PATCH)**
3. **API для получения списка всех поставок (GET)**
4. **API для удаления поставок (DELETE)**

---

## Требования

### Стек технологий

- **Python 3.10+**
- **FastAPI**
- **PostgreSQL**
- **psycopg2**
- **Docker**, **Docker Compose**

### Функционал

1. **Запчасти (Parts)**  
   - Создание новой запчасти.  
   - Получение списка всех запчастей.  
   - Обновление данных запчасти по ID.  
   - Удаление запчасти по ID.

2. **Поставщики (Suppliers)**  
   - Создание нового поставщика.  
   - Получение списка всех поставщиков.  
   - Обновление данных поставщика по ID.  
   - Удаление поставщика по ID.

3. **Поставки (Supplies)**  
   - Создание новой поставки, связывающей поставщика и запчасть.  
   - Получение списка всех поставок.  
   - Обновление данных поставки по ID.  
   - Удаление поставки по ID.

---

## Структура базы данных

### Таблица: `parts` (Запчасти)
| Поле           | Тип данных        | Описание                              |
|----------------|-------------------|---------------------------------------|
| `id`           | SERIAL (PK)       | Уникальный идентификатор запчасти     |
| `name`         | VARCHAR(255)      | Название запчасти                     |
| `description`  | TEXT              | Описание запчасти                     |
| `price`        | DECIMAL(10, 2)    | Цена за единицу                       |
| `in_stock`     | INTEGER           | Количество на складе                  |

---

### Таблица: `suppliers` (Поставщики)
| Поле           | Тип данных        | Описание                              |
|----------------|-------------------|---------------------------------------|
| `id`           | SERIAL (PK)       | Уникальный идентификатор поставщика   |
| `name`         | VARCHAR(255)      | Название поставщика                   |
| `contact`      | TEXT              | Контактная информация                 |

---

### Таблица: `supplies` (Поставки)
| Поле           | Тип данных        | Описание                              |
|----------------|-------------------|---------------------------------------|
| `id`           | SERIAL (PK)       | Уникальный идентификатор поставки     |
| `part_id`      | INTEGER (FK)      | ID запчасти (`parts.id`)              |
| `supplier_id`  | INTEGER (FK)      | ID поставщика (`suppliers.id`)        |
| `quantity`     | INTEGER           | Количество поставляемых запчастей     |
| `date`         | TIMESTAMP         | Дата поставки                         |

---

## Описание API
## Запчасти
### 1. Создание запчасти

- **Метод**: `POST /parts/`
- **Описание**: Позволяет создать запчасть. Данные сохраняются в PostgreSQL. Если запчасть с таким `name` уже существует, должен возвращаться код ошибки `400 Bad Request`. id (integer): Уникальный идентификатор поставщика.
- **Тело запроса**:
  ```json
  {
    "name": "string",
    "description": "string",
    "price": "decimal",
    "in_stock": "integer"
  }
  ```
- **Код ответа**: 200 (успешное создание) или 400 (если запчасть с таким `name` уже существует)
- **Ответ (при успешном запросе)**:
  ```json
  {
    "message": "Запчасть успешно создана"
  }
  ```
### 2. Обновление данных о запчасти

- **Метод**: `PATCH /parts/{part_id}`
- **Описание**: Позволяет обновить информацию о существующей запчасти по её идентификатору. Если запчасть с указанным идентификатором не найдена, должен возвращаться код ошибки `404 Not Found.`
- **Параметры**: `id (integer)` - уникальный идентификатор запчасти.
- **Тело запроса (пример обновления только некоторых полей)**:
  ```json
  {
  "name": "string",
  "description": "string",
  "price": "decimal",
  "in_stock": "integer"
  }
    ```
- **Код ответа**: 200 (успешное обновление) или 404 (если запчасть не найдена)
- **Ответ (при успешном запросе)**:
  ```json
  {
    "message": "Запчасть успешно обновлена"
  }
    ```
### 3. Удаление запчасти

- **Метод**: `DELETE /parts/{id}/`
- **Описание**: Позволяет удалить запчасть по её идентификатору. Если запчасть с указанным идентификатору не найдена, должен возвращаться код ошибки `404 Not Found.`
- **Параметры**: `id (integer)` - уникальный идентификатор запчасти.
- **Код ответа**: 200 (успешное удаление) или 404 (если запчасть с указанным id не найдена).
- **Ответ (при успешном запросе)**:
  ```json
  {
  "message": "Запчасть успешно удалена"
  }
    ```
### 4. Получение списка профилей запчастей

- **Метод**: `GET /parts/`
- **Описание**: Возвращает список всех запчастей, сохранённых в базе данных. Если запчасти отсутствуют, возвращается пустой массив.
- **Код ответа**: 200 (список профилей)
- **Ответ**:
  ```json
  [
  {
    "id": 1,
    "name": "string",
    "description": "string",
    "price": "decimal",
    "in_stock": "integer"
  },
  {
    "id": 2,
    "name": "string",
    "description": "string",
    "price": "decimal",
    "in_stock": "integer"
  }
  ]
  ```
## Поставщики
### 1. Создание поставщика

- **Метод**: `POST /suppliers/`
- **Описание**: Позволяет создать нового поставщика. Данные сохраняются в PostgreSQL. Если поставщик с таким name уже существует, должен возвращаться код ошибки `400 Bad Request.`
- **Тело запроса**:
  ```json
  {
  "name": "string",
  "contact": "string"
  }
  ```
- **Код ответа**: 200 (успешное создание) или 400 (если поставщик с таким name уже существует).
- **Ответ (при успешном запросе)**:
  ```json
  {
  "message": "Поставщик успешно создан"
  }
  ```
### 2. Обновление данных поставщика

- **Метод**: `PUT /suppliers/{id}/`
- **Описание**: Позволяет обновить данные о существующем поставщике по его идентификатору. Если поставщик с указанным идентификатору не найден, должен возвращаться код ошибки `404 Not Found.`
- **Параметры**: id (integer) - уникальный идентификатор поставщика.
- **Тело запроса**:
  ```json
  {
  "name": "string",
  "contact": "string"
  }
  ```
- **Код ответа**: 200 (успешное обновление) или 404 (если поставщик с указанным id не найден).
- **Ответ (при успешном запросе)**:
  ```json
  {
  "message": "Данные поставщика успешно обновлены"
  }
  ```
### 3. Удаление поставщика

- **Метод**: `DELETE /suppliers/{id}/`
- **Описание**: Позволяет удалить поставщика по его идентификатору. Если поставщик с указанным идентификатору не найден, должен возвращаться код ошибки `404 Not Found.`
- **Параметры**: id (integer) - уникальный идентификатор поставщика.
- **Код ответа**: 200 (успешное удаление) или 404 (если поставщик с указанным id не найден).
- **Ответ (при успешном запросе)**:
  ```json
  {
  "message": "Поставщик успешно удалён"
  }
  ```
  ### 4.  Получение списка всех поставщиков

- **Метод**: `GET /suppliers/`
- **Описание**: Возвращает список всех поставщиков, сохранённых в базе данных. Если поставщики отсутствуют, возвращается пустой массив.
- **Код ответа**: 200 
- **Тело запроса**:
  ```json
  [
  {
    "id": 1,
    "name": "string",
    "contact": "string"
  },
  {
    "id": 2,
    "name": "string",
    "contact": "string"
  }
  ]
  ```
## Поставки
### 1. Создание поставки

- **Метод**: `POST /supplies/`
- **Описание**: Позволяет создать новую поставку. Данные сохраняются в PostgreSQL. Если поставка с такими part_id и supplier_id уже существует, должен возвращаться код ошибки `400 Bad Request.`
- **Тело запроса**:
  ```json
  {
  "part_id": "integer",
  "supplier_id": "integer",
  "quantity": "integer",
  "date": "string"  
  }
  ```
- **Код ответа**: 200 (успешное создание) или 400 (если поставка с указанными part_id и supplier_id уже существует).
- **Ответ (при успешном запросе)**:
  ```json
  {
   "message": "Поставка успешно создана"
  }
  ```
### 2. Обновление данных поставки

- **Метод**: `PUT /supplies/{id}/`
- **Описание**: Позволяет обновить данные существующей поставки по её идентификатору. Если поставка с указанным идентификатору не найдена, должен возвращаться код ошибки `404 Not Found.`
- **Параметры**: id (integer) - уникальный идентификатор поставки.
- **Тело запроса**:
  ```json
  {
  "part_id": "integer",
  "supplier_id": "integer",
  "quantity": "integer",
  "date": "string"  
  }
  ```
- **Код ответа**: 200 (успешное обновление) или 404 (если поставка с указанным id не найдена).
- **Ответ (при успешном запросе)**:
  ```json
  {
  "message": "Данные поставки успешно обновлены"
  }
  ```
### 3. Удаление поставки

- **Метод**: `DELETE /supplies/{id}/`
- **Описание**: Позволяет удалить поставку по его идентификатору. Если поставка с указанным идентификатору не найден, должен возвращаться код ошибки `404 Not Found.`
- **Параметры**: id (integer) - уникальный идентификатор поставки.
- **Код ответа**: 200 (успешное удаление) или 404 (если поставка с указанным id не найден).
- **Ответ (при успешном запросе)**:
  ```json
  {
  "message": "Поставка успешно удалена"
  }
  ```
  ### 4.  Получение списка всех поставок

- **Метод**: `GET /supplies/`
- **Описание**: Возвращает список всех поставок, сохранённых в базе данных. Если поставки отсутствуют, возвращается пустой массив.
- **Код ответа**: 200 
- **Тело запроса**:
  ```json
  [
  {
    "id": 1,
    "part_id": "integer",
    "supplier_id": "integer",
    "quantity": "integer",
    "date": "string"  
  },
  {
    "id": 2,
    "part_id": "integer",
    "supplier_id": "integer",
    "quantity": "integer",
    "date": "string"  
  }
  ]
  ```


## Ожидаемые результаты

1. Код микросервиса с реализованными CRUD-операциями.  
2. Docker Compose файл для запуска базы данных PostgreSQL.  
3. Инструкция для разработчиков по установке, настройке и запуску проекта.  
4. SQL-скрипты для создания таблиц в базе данных.
